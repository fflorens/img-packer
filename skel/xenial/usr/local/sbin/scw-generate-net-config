#! /bin/bash

find /etc/network/interfaces.d/ -not -name "*.user.cfg" -type f -delete
for iface in $(ls /sys/class/net); do
    # Only configure physical interfaces
    if readlink /sys/class/net/$iface | grep --invert-match --silent 'virtual'; then
        echo """# Generated by $(basename $0)
auto $iface
iface $iface inet dhcp
""" > /etc/network/interfaces.d/$iface.cfg
    fi
done
